# рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃЏрЃўрЃЏрЃЮрЃ«рЃўрЃџрЃЋрЃљ РђЊ Walmart Recruiting: Store Sales Forecasting


## рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃљрЃдрЃгрЃћрЃарЃљ

  рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў рЃерЃћрЃўрЃфрЃљрЃЋрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃАрЃЋрЃћрЃбрЃћрЃЉрЃА:
  
  Store РђЊ рЃЏрЃљрЃдрЃљрЃќрЃўрЃўрЃА рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў рЃўрЃЊрЃћрЃюрЃбрЃўрЃцрЃўрЃЎрЃљрЃбрЃЮрЃарЃў
      
  Dept РђЊ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃўрЃА рЃўрЃЊрЃћрЃюрЃбрЃўрЃцрЃўрЃЎрЃљрЃбрЃЮрЃарЃў
  
  Date РђЊ рЃЎрЃЋрЃўрЃарЃўрЃА рЃърЃўрЃарЃЋрЃћрЃџрЃў рЃЊрЃдрЃћ (рЃЊрЃарЃЮрЃўрЃЌрЃў рЃдрЃћрЃарЃФрЃў)
  
  Weekly_Sales РђЊ рЃўрЃЏ рЃЎрЃЋрЃўрЃарЃљрЃерЃў рЃњрЃљрЃДрЃўрЃЊрЃБрЃџрЃў рЃърЃарЃЮрЃЊрЃБрЃЦрЃфрЃўрЃўрЃА рЃЌрЃљрЃюрЃ«рЃљ (рЃЕрЃЋрЃћрЃюрЃў рЃАрЃљрЃЏрЃўрЃќрЃюрЃћ рЃфрЃЋрЃџрЃљрЃЊрЃў)
  
  IsHoliday РђЊ рЃљрЃдрЃюрЃўрЃерЃюрЃБрЃџрЃў рЃЎрЃЋрЃўрЃарЃљ рЃЏрЃЮрЃўрЃфрЃљрЃЋрЃА рЃЌрЃБ рЃљрЃарЃљ рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃА
  
  рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌ рЃЏрЃЮрЃфрЃћрЃЏрЃБрЃџрЃўрЃљ:
  
  features.csv РђЊ рЃњрЃљрЃарЃћрЃњрЃљрЃюрЃў рЃцрЃљрЃЦрЃбрЃЮрЃарЃћрЃЉрЃў, рЃарЃЮрЃњрЃЮрЃарЃўрЃфрЃљрЃљ CPI, рЃЉрЃћрЃюрЃќрЃўрЃюрЃўрЃА рЃцрЃљрЃАрЃў, рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃўрЃА рЃЊрЃЮрЃюрЃћ рЃЊрЃљ рЃљ.рЃе.
  
  stores.csv РђЊ рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃўрЃА рЃбрЃўрЃърЃў рЃЊрЃљ рЃќрЃЮрЃЏрЃљ

## рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў 

  ### cleaning
  рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃАрЃљрЃгрЃДрЃўрЃА рЃћрЃбрЃљрЃърЃќрЃћ рЃЏрЃЮрЃ«рЃЊрЃљ рЃЏрЃЮрЃфрЃћрЃЏрЃБрЃџрЃў рЃАрЃљрЃЏрЃўрЃЋрЃћ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃўрЃА рЃцрЃљрЃўрЃџрЃўрЃА (train.csv, features.csv, stores.csv) рЃњрЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃћрЃЉрЃљ Store рЃЊрЃљ Date рЃАрЃЋрЃћрЃбрЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ.
  Weekly_Sales рЃфрЃЋрЃџрЃљрЃЊрЃерЃў рЃљрЃдрЃЏрЃЮрЃЕрЃћрЃюрЃўрЃџрЃў рЃБрЃљрЃарЃДрЃЮрЃцрЃўрЃЌрЃў рЃљрЃю рЃюрЃБрЃџрЃЮрЃЋрЃљрЃюрЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў рЃгрЃљрЃарЃЏрЃЮрЃљрЃЊрЃњрЃћрЃюрЃЊрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ 0.3%-рЃА. рЃўрЃАрЃўрЃюрЃў рЃўрЃЦрЃюрЃљ рЃљрЃЏрЃЮрЃдрЃћрЃЉрЃБрЃџрЃў.
  Markdown рЃАрЃЋрЃћрЃбрЃћрЃЉрЃерЃў рЃўрЃДрЃЮ рЃЉрЃћрЃЋрЃарЃў NaN рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ. рЃўрЃАрЃўрЃюрЃў рЃЕрЃљрЃЋрЃљрЃюрЃљрЃфрЃЋрЃџрЃћрЃЌ 0-рЃўрЃЌ.
  ### рЃЌрЃљрЃарЃўрЃдрЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ
  -- Date рЃЋрЃћрЃџрЃў рЃњрЃљрЃарЃЊрЃљрЃўрЃЦрЃЏрЃюрЃљ datetime рЃцрЃЮрЃарЃЏрЃљрЃбрЃерЃў, рЃарЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњрЃљрЃф рЃерЃћрЃўрЃЦрЃЏрЃюрЃљ рЃљрЃ«рЃљрЃџрЃў рЃАрЃЋрЃћрЃбрЃћрЃЉрЃў:
            year,month,week.
  -- рЃљрЃАрЃћрЃЋрЃћ рЃњрЃљрЃюрЃЋрЃљрЃЌрЃљрЃЋрЃАрЃћрЃЌ рЃЮрЃЌрЃ«рЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃў рЃфрЃљрЃџрЃЎрЃћ рЃЉрЃБрЃџрЃўрЃљрЃю рЃАрЃЋрЃћрЃбрЃћрЃЉрЃљрЃЊ, рЃарЃљрЃЊрЃњрЃљрЃю рЃњрЃЋрЃўрЃюрЃЊрЃЮрЃЊрЃљ рЃњрЃЋрЃћрЃюрЃљрЃ«рЃљ , рЃарЃЮрЃњрЃЮрЃа рЃўрЃДрЃЮ рЃЊрЃљрЃЏрЃЮрЃЎрЃўрЃЊрЃћрЃЉрЃБрЃџрЃў weekly_sales рЃЏрЃљрЃЌрЃЌрЃљрЃю:
            Thanksgiving,Christmas,Super_Bowl,Labor_Day


 
  ![image](https://github.com/user-attachments/assets/b6a1d80e-30d2-4a18-86a5-6f4a990184c6)

  
  ![image](https://github.com/user-attachments/assets/0c2b497f-999e-44c8-abdc-cf68d596c057)


  ![image](https://github.com/user-attachments/assets/219e6d87-26f2-496f-b189-13029ed87c5c)


  ![image](https://github.com/user-attachments/assets/363bf5f2-fc18-4521-8b68-f74acce58a48)


  ![image](https://github.com/user-attachments/assets/e5ad498a-f0db-4a34-893e-9be6df769040)



  рЃЕрЃљрЃюрЃА , рЃарЃЮрЃЏ Labor Day рЃЊрЃљ Christmas рЃФрЃљрЃџрЃўрЃљрЃю рЃљрЃа рЃфрЃЋрЃџрЃўрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃА. рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃћрЃбрЃљрЃЊ рЃЏрЃљрЃАрЃќрЃћ рЃљрЃ«рЃЊрЃћрЃюрЃА рЃќрЃћрЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃћрЃЉрЃљрЃА Thanksgiving.


  ## рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃћрЃЉрЃў рЃЊрЃљ рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃў
  
  рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў рЃЏрЃЮрЃўрЃфрЃљрЃЋрЃА 45 рЃЏрЃљрЃдрЃљрЃќрЃўрЃљрЃА рЃЊрЃљ 81 рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃА РђЊ рЃЌрЃБрЃЏрЃфрЃљ рЃДрЃЋрЃћрЃџрЃљ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃў рЃљрЃа рЃљрЃарЃўрЃА рЃ«рЃћрЃџрЃЏрЃўрЃАрЃљрЃгрЃЋрЃЊрЃЮрЃЏрЃў рЃДрЃЋрЃћрЃџрЃљ рЃЏрЃљрЃдрЃљрЃќрЃўрЃљрЃерЃў.
  рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃљрЃдрЃљрЃџрЃў рЃАрЃљрЃерЃБрЃљрЃџрЃЮ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃ░рЃЦрЃЮрЃюрЃЊрЃљ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃА 92, рЃЌрЃБрЃЏрЃфрЃљ рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃљрЃдрЃљрЃџрЃў рЃўрЃюрЃЊрЃўрЃЋрЃўрЃЊрЃБрЃљрЃџрЃБрЃарЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃўрЃДрЃЮ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃў 72-рЃерЃў, рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃљрЃЊ Thanksgiving-рЃўрЃА рЃЎрЃЋрЃўрЃарЃљрЃерЃў.

  рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃА рЃљрЃЦрЃЋрЃЌ рЃбрЃўрЃърЃћрЃЉрЃў A, B, C Рђћ рЃбрЃўрЃърЃў A рЃБрЃЊрЃўрЃЊрЃћрЃАрЃўрЃљ рЃќрЃЮрЃЏрЃўрЃЌ (>150,000), рЃЊрЃљ рЃЏрЃљрЃА рЃљрЃЦрЃЋрЃА рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃљрЃдрЃљрЃџрЃў рЃАрЃљрЃерЃБрЃљрЃџрЃЮ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў.

  рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃљрЃдрЃљрЃџрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃЊрЃљрЃцрЃўрЃЦрЃАрЃўрЃарЃЊрЃљ Thanksgiving-рЃўрЃА, Christmas-рЃўрЃА рЃЊрЃљ Black Friday-рЃўрЃА рЃЎрЃЋрЃўрЃарЃћрЃЉрЃерЃў (рЃЎрЃЋрЃўрЃарЃћрЃЉрЃў 47РђЊ51).

  
  
  ![image](https://github.com/user-attachments/assets/578b19a8-659d-432f-862b-61ae0503caff)


  ![image](https://github.com/user-attachments/assets/5da5436a-f2fd-4149-8cf5-aee4382f5089)


  ![image](https://github.com/user-attachments/assets/16f07a85-c2ca-475d-bbee-dca926a10da0)


  ![image](https://github.com/user-attachments/assets/43305902-de05-446a-bd66-bd0ac2328d52)


  ![image](https://github.com/user-attachments/assets/a1708504-c633-43b8-a3ba-8f1f2f737c34)


  рЃЦрЃЋрЃћрЃЊрЃљ рЃњрЃцрЃљрЃцрЃў рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃА рЃгрЃџрЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ.

  

  ![image](https://github.com/user-attachments/assets/603177ee-071d-4e42-a131-919f8bc016fb)

  

  рЃЎрЃЋрЃўрЃарЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ:


  ![image](https://github.com/user-attachments/assets/730193dc-8cbb-40bb-b3ef-989a510be193)



   CPI, Fuel Price, Unemployment, Temperature рЃљрЃа рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃњрЃљрЃЏрЃЮрЃЎрЃЋрЃћрЃЌрЃўрЃџ рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљрЃА Weekly_Sales-рЃЌрЃљрЃю.



   ![image](https://github.com/user-attachments/assets/116c2ee3-530f-4b9b-8b44-e9f84e6ad605)



   ![image](https://github.com/user-attachments/assets/22c91452-e4fb-44ea-84f8-69c5fb72dfde)



   ![image](https://github.com/user-attachments/assets/a9d92048-8f56-49bf-9350-b2f6eca4185a)



   ![image](https://github.com/user-attachments/assets/c2c4b0ed-8aa4-4d05-8b5e-f9d612be6bf6)



# рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў 
 
 ## рЃЏрЃЮрЃЊрЃћрЃџрЃў: DLinear (Decomposition Linear)
   рЃљрЃЏ рЃърЃарЃЮрЃћрЃЦрЃбрЃерЃў рЃЊрЃљрЃўрЃбрЃћрЃАрЃбрЃљ DLinear рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ NeuralForecast рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃЌ.

   ### рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ:
   
    * horizon: 28 (forecast horizon in weeks)
    * input_size: 30 (look-back window in weeks)
    * epochs (max_steps): 500
    * batch_size: 64
    * learning_rate: 1e-3

  рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃбрЃарЃћрЃюрЃЊрЃћрЃЉрЃљ Weights & Biases (W&B) рЃърЃџрЃљрЃбрЃцрЃЮрЃарЃЏрЃљрЃќрЃћ, рЃАрЃљрЃЊрЃљрЃф рЃ«рЃЊрЃћрЃЉрЃљ рЃДрЃЋрЃћрЃџрЃљ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃў рЃџрЃЮрЃњрЃўрЃарЃћрЃЉрЃљ.

  ### рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ

    * рЃБрЃљрЃарЃДрЃЮрЃцрЃўрЃЌрЃў Weekly_Sales рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў рЃњрЃљрЃЊрЃљрЃЎрЃћрЃЌрЃЊрЃљ рЃюрЃБрЃџрЃќрЃћ
    * рЃерЃћрЃўрЃЦрЃЏрЃюрЃљ рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў рЃўрЃЊрЃћрЃюрЃбрЃўрЃцрЃўрЃЎрЃљрЃбрЃЮрЃарЃў Store_Dept рЃцрЃЮрЃарЃЏрЃљрЃбрЃўрЃЌ
    * Date рЃњрЃљрЃЊрЃљрЃћрЃарЃЦрЃЋрЃљ ds, рЃ«рЃЮрЃџрЃЮ Weekly_Sales РђЊ y, рЃарЃљрЃЌрЃљ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃЌрЃљрЃЋрЃАрЃћрЃЉрЃљрЃЊрЃў рЃДрЃЮрЃцрЃўрЃџрЃўрЃДрЃЮ NeuralForecast рЃцрЃЮрЃарЃЏрЃљрЃбрЃЌрЃљрЃю

  ### рЃерЃћрЃўрЃЦрЃЏрЃюрЃљ DLinearNF рЃЎрЃџрЃљрЃАрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃўрЃФрЃџрЃћрЃЋрЃљ:
      * рЃљрЃљрЃњрЃЮрЃА DLinear рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃЏрЃЮрЃарЃњрЃћрЃЉрЃБрЃџрЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃЌ (h рЃЊрЃљ input_size)
      * рЃњрЃљрЃ«рЃЊрЃћрЃА рЃЌрЃљрЃЋрЃАрЃћрЃЉрЃљрЃЊрЃў NeuralForecast рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљрЃАрЃЌрЃљрЃю
      * рЃњрЃљрЃљрЃЦрЃбрЃўрЃБрЃарЃЮрЃА start_padding_enabled, рЃарЃљрЃЌрЃљ рЃњрЃљрЃўрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃЮрЃА рЃЏрЃЮрЃЎрЃџрЃћ рЃАрЃћрЃарЃўрЃћрЃЉрЃў
      * рЃњрЃљрЃБрЃерЃЋрЃљрЃА рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў рЃЊрЃљ рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃў fit() рЃЊрЃљ predict() рЃЏрЃћрЃЌрЃЮрЃЊрЃћрЃЉрЃўрЃЌ



##  рЃЏрЃЮрЃЊрЃћрЃџрЃў: PatchTST

### рЃЏрЃўрЃЏрЃЮрЃ«рЃўрЃџрЃЋрЃљ

рЃљрЃдрЃюрЃўрЃерЃюрЃБрЃџ рЃюрЃљрЃгрЃўрЃџрЃерЃў рЃљрЃњрЃћрЃЉрЃБрЃџрЃў рЃўрЃДрЃЮ **PatchTST** рЃбрЃўрЃърЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃўрЃА pipeline, рЃарЃЮрЃЏрЃџрЃўрЃА рЃЏрЃўрЃќрЃљрЃюрЃўрЃљ Walmart-рЃўрЃА рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃАрЃћрЃарЃўрЃўрЃАрЃЌрЃЋрЃўрЃА рЃџрЃЮрЃЎрЃљрЃџрЃБрЃарЃў рЃЊрЃљ рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў рЃЊрЃарЃЮрЃўрЃЌрЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃўрЃА рЃЊрЃљрЃГрЃћрЃарЃљ рЃДрЃЋрЃћрЃџрЃљ StoreРђЊItem рЃАрЃћрЃарЃўрЃљрЃќрЃћ.

### рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃџрЃЮрЃњрЃўрЃЎрЃљ

1. **рЃАрЃџрЃљрЃўрЃЊрЃўрЃюрЃњ рЃцрЃљрЃюрЃ»рЃарЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃцрЃЮрЃарЃЏрЃљрЃбрЃўрЃарЃћрЃЉрЃљ:** рЃДрЃЮрЃЋрЃћрЃџрЃў рЃЊрЃарЃЮрЃўрЃЌрЃў рЃАрЃћрЃарЃўрЃљ рЃЊрЃљрЃўрЃДрЃЮ рЃцрЃўрЃЦрЃАрЃўрЃарЃћрЃЉрЃБрЃџрЃў рЃАрЃўрЃњрЃарЃФрЃўрЃА рЃерЃћрЃАрЃљрЃбрЃљрЃюрЃў рЃЊрЃљ рЃАрЃљрЃЏрЃўрЃќрЃюрЃћ рЃцрЃљрЃюрЃ»рЃарЃћрЃЉрЃљрЃЊ, рЃарЃљрЃф рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃљрЃФрЃџрЃћрЃЋрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃА рЃўрЃАрЃгрЃљрЃЋрЃџрЃЮрЃА рЃ»рЃњрЃБрЃцрЃБрЃарЃљрЃЊ рЃърЃљрЃбрЃЕрЃћрЃЉрЃќрЃћ.
2. **PatchTST рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ:** рЃерЃћрЃАрЃљрЃбрЃљрЃюрЃў рЃАрЃћрЃарЃўрЃћрЃЉрЃў рЃўрЃДрЃЮрЃцрЃљ рЃњрЃљрЃЊрЃљрЃцрЃљрЃарЃЋрЃљрЃЊ рЃърЃљрЃбрЃЕрЃћрЃЉрЃљрЃЊ. рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА self-attention рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃА, рЃарЃљрЃЌрЃљ рЃўрЃАрЃгрЃљрЃЋрЃџрЃЮрЃА рЃарЃЮрЃњрЃЮрЃарЃф рЃћрЃарЃЌ рЃърЃљрЃбрЃЕрЃерЃў рЃљрЃарЃАрЃћрЃЉрЃБрЃџрЃў рЃўрЃАрЃћ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃърЃљрЃбрЃЕрЃўрЃА рЃњрЃљрЃЊрЃљрЃЎрЃЋрЃћрЃЌрЃўрЃА рЃЊрЃљрЃЏрЃЮрЃЎрЃўрЃЊрЃћрЃЉрЃБрЃџрЃћрЃЉрЃћрЃЉрЃў РђЊ рЃарЃљрЃф рЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃћрЃЉрЃА рЃњрЃарЃФрЃћрЃџрЃЋрЃљрЃЊрЃўрЃљрЃюрЃў рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљрЃА.
3. **рЃАрЃарЃБрЃџрЃў рЃўрЃАрЃбрЃЮрЃарЃўрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ рЃЊрЃљ Hold-Out рЃбрЃћрЃАрЃбрЃў:** рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћрЃЮрЃЉрЃА рЃЏрЃЌрЃџрЃўрЃљрЃю рЃ«рЃћрЃџрЃЏрЃўрЃАрЃљрЃгрЃЋрЃЊрЃЮрЃЏ рЃўрЃАрЃбрЃЮрЃарЃўрЃљрЃќрЃћ, рЃ«рЃЮрЃџрЃЮ рЃбрЃћрЃАрЃбрЃўрЃА рЃ░рЃЮрЃарЃўрЃќрЃЮрЃюрЃбрЃќрЃћ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃљрЃЎрЃћрЃЌрЃћрЃЉрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃА рЃЊрЃљ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃБрЃџрЃўрЃљ рЃарЃћрЃљрЃџрЃБрЃа рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃЌрЃљрЃю.

### рЃАрЃгрЃљрЃЋрЃџрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃфрЃћрЃАрЃў

- Optimizer: **Adam**, рЃЏрЃўрЃќрЃљрЃюрЃў: **MSE** рЃЏрЃўрЃюрЃўрЃЏрЃўрЃќрЃљрЃфрЃўрЃљ
- рЃДрЃЮрЃЋрЃћрЃџрЃў epoch-рЃА рЃџрЃЮрЃАрЃў рЃџрЃЮрЃњрЃўрЃарЃћрЃЉрЃБрЃџрЃўрЃљ **Weights & Biases** рЃърЃџрЃљрЃбрЃцрЃЮрЃарЃЏрЃљрЃќрЃћ рЃЏрЃЮрЃюрЃўрЃбрЃЮрЃарЃўрЃюрЃњрЃўрЃАрЃЌрЃЋрЃўрЃА

### рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ

- Hold-out рЃцрЃљрЃюрЃ»рЃљрЃарЃљрЃќрЃћ рЃњрЃљрЃЏрЃЮрЃўрЃЌрЃЋрЃљрЃџрЃљ рЃЮрЃарЃў рЃЏрЃћрЃбрЃарЃўрЃЎрЃљ:
  - **SMAPE (Symmetric Mean Absolute Percentage Error)**
  - **MAE (Mean Absolute Error)**
- рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃАрЃћрЃарЃўрЃўрЃА рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ рЃљрЃњрЃарЃћрЃњрЃўрЃарЃЊрЃљ рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃа рЃЊрЃЮрЃюрЃћрЃќрЃћ рЃАрЃљрЃћрЃарЃЌрЃЮ рЃАрЃўрЃќрЃБрЃАрЃбрЃўрЃА рЃЏрЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃџрЃљрЃЊ



## рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў: ARIMA рЃЊрЃљ SARIMA

### 1. ARIMA РђЊ рЃАрЃљрЃгрЃДрЃўрЃАрЃў Benchmark

**рЃЏрЃўрЃќрЃљрЃюрЃў:** 
рЃЊрЃарЃЮрЃўрЃЌрЃў рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃАрЃљрЃгрЃДрЃўрЃАрЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃЊрЃљ рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃЉрЃљрЃќрЃўрЃАрЃБрЃарЃў рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃА рЃерЃћрЃЦрЃЏрЃюрЃљ.

**рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ:**
- рЃЊрЃљрЃбрЃЋрЃўрЃарЃЌрЃБрЃџрЃў рЃўрЃДрЃЮ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃАрЃћрЃарЃўрЃљ `(Store, Dept)` рЃгрЃДрЃЋрЃўрЃџрЃўрЃАрЃЌрЃЋрЃўрЃА.
- рЃДрЃЮрЃЋрЃћрЃџ рЃАрЃћрЃарЃўрЃљрЃќрЃћ рЃЏрЃЮрЃ«рЃЊрЃљ **ARIMA (1,1,1)** рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃњрЃљрЃерЃЋрЃћрЃЉрЃљ `statsmodels` рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃўрЃЌ.
- рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃљ **MAE (Mean Absolute Error)** рЃЏрЃћрЃбрЃарЃўрЃЎрЃўрЃЌ.

** рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃљ:**  
рЃЏрЃЮрЃЊрЃћрЃџрЃЏрЃљ рЃЎрЃљрЃарЃњрЃљрЃЊ рЃЊрЃљрЃљрЃцрЃўрЃЦрЃАрЃўрЃарЃљ рЃќрЃЮрЃњрЃљрЃЊрЃў рЃбрЃарЃћрЃюрЃЊрЃў, рЃЌрЃБрЃЏрЃфрЃљ рЃЋрЃћрЃа рЃњрЃљрЃБрЃЏрЃЎрЃџрЃљрЃЋрЃЊрЃљ рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃА.

---

### 2.  SARIMA РђЊ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ


** рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ:**
- рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃўрЃДрЃЮ **SARIMAX** рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃЌ: `(0,1,1,52)` РђЊ рЃарЃљрЃф рЃгрЃћрЃџрЃўрЃгрЃљрЃЊрЃўрЃА рЃАрЃћрЃќрЃЮрЃюрЃБрЃа рЃфрЃўрЃЎрЃџрЃА рЃЏрЃЮрЃўрЃфрЃљрЃЋрЃА.
- рЃЊрЃљрЃћрЃЏрЃљрЃбрЃљ рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў (`Temperature`, `Fuel_Price`, `CPI`, `Unemployment`).
- рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃўрЃА рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃў рЃЊрЃљ рЃЊрЃўрЃљрЃњрЃюрЃЮрЃАрЃбрЃўрЃЎрЃљ рЃЊрЃљрЃўрЃџрЃЮрЃњрЃљ **Weights & Biases (W&B)**-рЃќрЃћ.

** рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃљ:**  
рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЏрЃљ рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃћрЃЉрЃЏрЃљ рЃЊрЃљ рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃЏрЃљ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃЏрЃљ рЃњрЃљрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃћрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃў, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃАрЃгрЃљрЃЋрЃџрЃљ рЃЌрЃўрЃЌрЃЮ рЃАрЃћрЃарЃўрЃљрЃќрЃћ рЃФрЃљрЃџрЃўрЃљрЃю рЃюрЃћрЃџрЃў рЃўрЃДрЃЮ.



 ##  рЃЏрЃЮрЃЊрЃћрЃџрЃў: LightGBM РђЊ рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃљрЃфрЃўрЃљ


### ­ЪЏа№ИЈ рЃћрЃбрЃљрЃърЃћрЃЉрЃў рЃЊрЃљ рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃћрЃЉрЃў

#### рЃАрЃљрЃгрЃДрЃўрЃАрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў (Baseline)


- **рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў:**
  - MAE: ~1,700
  - рЃАрЃгрЃљрЃЋрЃџрЃћрЃЉрЃўрЃА рЃЊрЃарЃЮ: 30+ рЃгрЃБрЃЌрЃў
- **рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ:** рЃќрЃћрЃЊрЃЏрЃћрЃбрЃљрЃЊ рЃњрЃљрЃЊрЃљрЃбрЃЋрЃўрЃарЃЌрЃБрЃџрЃў рЃљрЃарЃљрЃАрЃљрЃГрЃўрЃарЃЮ рЃЏрЃљрЃ«рЃљрЃАрЃўрЃљрЃЌрЃћрЃЉрЃџрЃћрЃЉрЃўрЃЌ.

---

#### рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃўрЃарЃћрЃЉрЃБрЃџрЃў рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃў

** рЃњрЃљрЃюрЃ«рЃЮрЃарЃфрЃўрЃћрЃџрЃћрЃЉрЃБрЃџрЃў рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃћрЃЉрЃў:**

1. **рЃЏрЃљрЃ«рЃљрЃАрЃўрЃљрЃЌрЃћрЃЉрЃџрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃљрЃарЃбрЃўрЃЋрЃћрЃЉрЃљ:**
   - рЃЊрЃљрЃбрЃЮрЃЋрЃћрЃЉрЃБрЃџрЃўрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў: `Super_Bowl`, `Thanksgiving`
   - рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃБрЃџрЃўрЃљ `Days_Until_Holiday` РђЊ рЃЊрЃљрЃћрЃ«рЃЏрЃљрЃарЃЮрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃА рЃЏрЃЮрЃАрЃљрЃџрЃЮрЃЊрЃюрЃћрЃџрЃў рЃќрЃарЃЊрЃўрЃА рЃгрЃўрЃюрЃљрЃАрЃгрЃљрЃа рЃюрЃљрЃ«рЃЋрЃљрЃерЃў
   -  рЃАрЃбрЃљрЃбрЃўрЃАрЃбрЃўрЃЎрЃћрЃЉрЃўрЃЊрЃљрЃю рЃЊрЃљрЃарЃЕрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ 4-рЃЎрЃЋрЃўрЃарЃўрЃљрЃюрЃў рЃАрЃљрЃерЃБрЃљрЃџрЃЮ

2. **рЃАрЃгрЃљрЃЋрЃџрЃўрЃА рЃљрЃЕрЃЦрЃљрЃарЃћрЃЉрЃљ:**
   - Boosting рЃбрЃўрЃърЃў рЃерЃћрЃфрЃЋрЃџрЃўрЃџрЃўрЃљ `dart`-рЃўрЃЊрЃљрЃю `gbdt`-рЃќрЃћ (рЃАрЃгрЃљрЃЋрЃџрЃљ рЃњрЃљрЃ«рЃЊрЃљ 3-рЃ»рЃћрЃа рЃАрЃгрЃарЃљрЃцрЃў)
   - `learning_rate` рЃњрЃљрЃќрЃарЃЊрЃўрЃџрЃў 0.03-рЃЊрЃљрЃю 0.1-рЃЏрЃЊрЃћ рЃЊрЃљ `num_rounds` рЃерЃћрЃЏрЃфрЃўрЃарЃЊрЃљ 2000-рЃЊрЃљрЃю 800-рЃЏрЃЊрЃћ
   - `num_leaves` рЃерЃћрЃЏрЃфрЃўрЃарЃЊрЃљ Рєњ рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃЮрЃЉрЃўрЃА рЃерЃћрЃЏрЃфрЃўрЃарЃћрЃЉрЃљ, рЃЌрЃБрЃЏрЃфрЃљ рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃБрЃџрЃўрЃљ `lambda_l2`, рЃарЃљрЃЌрЃљ рЃљрЃўрЃфрЃўрЃџрЃЮрЃА overlearning

3. **рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў:**
   
   - рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃБрЃџрЃўрЃљ `Pre_Holiday_Week` рЃфрЃЋрЃџрЃљрЃЊрЃў, рЃарЃљрЃЌрЃљ рЃЊрЃљрЃўрЃГрЃўрЃарЃЮрЃА рЃЊрЃдрЃћрЃЏрЃЊрЃћ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃЏрЃљрЃбрЃћрЃЉрЃљ.

---

###  рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў

| рЃЏрЃћрЃбрЃарЃўрЃЎрЃљ | рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ |
|--------|-------------|
| **MAE** | 1,154 *(рЃгрЃўрЃюрЃљ 1,700-рЃќрЃћ)* |
| **WMAE** | 1,178 *(рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ 2%-рЃўрЃЌ рЃЏрЃћрЃбрЃў Рєњ рЃЏрЃљрЃдрЃљрЃџрЃў рЃАрЃўрЃќрЃБрЃАрЃбрЃћ рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃќрЃћ)* |
| **рЃАрЃгрЃљрЃЋрЃџрЃћрЃЉрЃўрЃА рЃЊрЃарЃЮ** | 5 рЃгрЃБрЃЌрЃў *(рЃгрЃўрЃюрЃљ 30 рЃгрЃБрЃЌрЃќрЃћ)* |


##  рЃЏрЃЮрЃЊрЃћрЃџрЃў: Prophet



### РџЎ№ИЈ рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ

- **рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃгрЃўрЃюрЃљрЃЏрЃќрЃљрЃЊрЃћрЃЉрЃљ:**
  - рЃњрЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃЊрЃљ `train.csv`, `features.csv`, `stores.csv` рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў.
  - `Weekly_Sales` рЃњрЃљрЃЊрЃљрЃћрЃарЃЦрЃЋрЃљ `y`, рЃ«рЃЮрЃџрЃЮ `Date` РђЊ `ds`, Prophet-рЃАрЃЌрЃЋрЃўрЃА рЃАрЃљрЃГрЃўрЃарЃЮ рЃцрЃЮрЃарЃЏрЃљрЃбрЃерЃў.
  - рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃўрЃљ US-рЃўрЃА рЃЮрЃцрЃўрЃфрЃўрЃљрЃџрЃБрЃарЃў рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў (`holidays` рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃўрЃЌ).
  - рЃњрЃљрЃДрЃЮрЃцрЃўрЃџрЃў рЃўрЃДрЃЮ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў 80% рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃќрЃћ рЃЊрЃљ 20% рЃбрЃћрЃАрЃбрЃќрЃћ рЃЊрЃарЃЮрЃўрЃЌ рЃАрЃћрЃЦрЃЋрЃћрЃюрЃАрЃўрЃЌ.

- **рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃўрЃА рЃЏрЃљрЃ«рЃљрЃАрЃўрЃљрЃЌрЃћрЃЉрЃџрЃћрЃЉрЃў:**
  - рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃљ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў `(Store, Dept)` рЃАрЃћрЃарЃўрЃўрЃАрЃЌрЃЋрЃўрЃА рЃўрЃюрЃЊрЃўрЃЋрЃўрЃЊрЃБрЃљрЃџрЃБрЃарЃљрЃЊ.
  - рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў:
    - `changepoint_prior_scale`: 0.15
    - `seasonality_prior_scale`: 10.0
    - `holidays_prior_scale`: 10.0
    - `yearly_seasonality`: `True`
    - `weekly_seasonality`: `True`
    - `seasonality_mode`: `"multiplicative"`

- **рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃўрЃА рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃў:**
  - `MAE`, `RMSE` рЃЊрЃљ **WMAE** (рЃАрЃљрЃАрЃгрЃЮрЃарЃўрЃљрЃюрЃў MAE рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃќрЃћ рЃњрЃљрЃюрЃАрЃљрЃЎрЃБрЃЌрЃарЃћрЃЉрЃБрЃџрЃў рЃДрЃБрЃарЃљрЃЊрЃдрЃћрЃЉрЃўрЃЌ).
  - рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА рЃЎрЃЋрЃўрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃўрЃДрЃЮ рЃгрЃЮрЃюрЃљ 5, рЃЊрЃљрЃюрЃљрЃарЃЕрЃћрЃюрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА 1.

- **рЃџрЃЮрЃњрЃўрЃарЃћрЃЉрЃљ рЃЊрЃљ рЃерЃћрЃюрЃљрЃ«рЃЋрЃљ:**
  - рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў рЃЊрЃљ рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃў рЃЊрЃљрЃџрЃЮрЃњрЃЊрЃљ **Weights & Biases (W&B)** рЃърЃџрЃљрЃбрЃцрЃЮрЃарЃЏрЃљрЃќрЃћ.
  - рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў рЃерЃћрЃюрЃљрЃ«рЃБрЃџрЃўрЃљ рЃўрЃюрЃЊрЃўрЃЋрЃўрЃЊрЃБрЃљрЃџрЃБрЃарЃљрЃЊ `.pkl` рЃцрЃљрЃўрЃџрЃћрЃЉрЃљрЃЊ (`models/prophet_store{X}_dept{Y}.pkl`).
  - рЃДрЃЋрЃћрЃџрЃљ рЃАрЃћрЃарЃўрЃўрЃА рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў рЃерЃћрЃюрЃљрЃ«рЃБрЃџрЃўрЃљ CSV рЃцрЃљрЃўрЃџрЃерЃў рЃЊрЃљ рЃљрЃбрЃЋрЃўрЃарЃЌрЃБрЃџрЃўрЃљ рЃарЃЮрЃњрЃЮрЃарЃф W&B рЃљрЃарЃбрЃўрЃцрЃљрЃЦрЃбрЃў.

---

### рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃћрЃЉрЃў

- Prophet рЃЏрЃЮрЃљрЃ«рЃћрЃарЃ«рЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃбрЃћрЃюрЃЊрЃћрЃюрЃфрЃўрЃћрЃЉрЃўрЃАрЃљ рЃЊрЃљ рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА рЃћрЃцрЃћрЃЦрЃбрЃћрЃЉрЃўрЃА рЃЊрЃљрЃГрЃћрЃарЃљ.
- рЃЌрЃБрЃЏрЃфрЃљ, рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃўрЃА рЃЊрЃарЃЮ рЃЊрЃљ рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃў рЃўрЃќрЃарЃЊрЃћрЃЉрЃЮрЃЊрЃљ рЃЌрЃўрЃЌрЃЮ рЃАрЃћрЃарЃўрЃљрЃќрЃћ рЃўрЃюрЃЊрЃўрЃЋрЃўрЃЊрЃБрЃљрЃџрЃБрЃарЃў рЃАрЃгрЃљрЃЋрЃџрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮ.
- **WMAE рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў** рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃЊрЃљ, рЃарЃЮрЃЏ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ рЃЎрЃљрЃарЃњрЃљрЃЊ рЃњрЃљрЃБрЃЏрЃЎрЃџрЃљрЃЋрЃЊрЃљ рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃА.

рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮрЃЊ, Prophet рЃљрЃдрЃЏрЃЮрЃЕрЃюрЃЊрЃљ рЃЎрЃљрЃарЃњрЃў рЃЎрЃџрЃљрЃАрЃўрЃЎрЃБрЃарЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃЌ рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃА рЃўрЃюрЃбрЃћрЃарЃърЃарЃћрЃбрЃўрЃарЃћрЃЉрЃљрЃЊ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃА рЃЊрЃљ рЃЎрЃљрЃарЃњрЃљрЃЊ рЃћрЃарЃњрЃћрЃЉрЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃАрЃћрЃарЃўрЃћрЃЉрЃА.


##  рЃЏрЃЮрЃЊрЃћрЃџрЃў: XGBoost


###  рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ

- **рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃЏрЃЮрЃЏрЃќрЃљрЃЊрЃћрЃЉрЃљ:**
  - рЃњрЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃЊрЃљ `train.csv`, `features.csv`, `stores.csv`.
  - рЃерЃћрЃЦрЃЏрЃюрЃўрЃџрЃўрЃљ рЃљрЃ«рЃљрЃџрЃў рЃЌрЃЋрЃўрЃАрЃћрЃЉрЃћрЃЉрЃў:
    - рЃЌрЃљрЃарЃўрЃдрЃўрЃА рЃюрЃљрЃгрЃўрЃџрЃћрЃЉрЃў: `Year`, `Month`, `Week`, `Day`
    - рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃўрЃА рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃў: `IsHoliday`, `IsUSHoliday`
    - `Type` рЃњрЃљрЃЊрЃљрЃДрЃЋрЃљрЃюрЃўрЃџрЃўрЃљ one-hot рЃцрЃЮрЃарЃЏрЃљрЃбрЃерЃў
    - Lag рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў: 4-рЃЎрЃЋрЃўрЃарЃўрЃљрЃюрЃў рЃЊрЃљ 52-рЃЎрЃЋрЃўрЃарЃўрЃљрЃюрЃў рЃгрЃўрЃюрЃљ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў
  - рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃерЃћрЃЋрЃАрЃћрЃЉрЃБрЃџрЃўрЃљ `fillna(0)`РђЊрЃўрЃЌ

- **рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў (W&B Config):**
  - `n_estimators`: 2500
  - `learning_rate`: 0.02
  - `max_depth`: 8
  - `subsample`, `colsample_bytree`: 0.75
  - `gamma`: 0.1
  - `min_child_weight`: 5
  - рЃарЃћрЃњрЃБрЃџрЃљрЃарЃўрЃќрЃљрЃфрЃўрЃљ: `reg_alpha`, `reg_lambda`: 0.1
  - `tree_method`: `"hist"` (рЃАрЃгрЃарЃљрЃцрЃў рЃ«рЃўрЃА рЃљрЃњрЃћрЃЉрЃљ)

- **Train/Test рЃњрЃљрЃДрЃЮрЃцрЃљ:**
  - рЃњрЃљрЃюрЃ«рЃЮрЃарЃфрЃўрЃћрЃџрЃЊрЃљ рЃЊрЃарЃЮрЃўрЃЌ 80/20 рЃњрЃљрЃДрЃЮрЃцрЃљ (`Date` рЃЋрЃћрЃџрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ)
  - рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћрЃЮрЃЉрЃЊрЃљ `DMatrix` рЃцрЃЮрЃарЃЏрЃљрЃбрЃерЃў
  - Early stopping рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃўрЃљ 100 epoch-рЃќрЃћ

---

### рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ

- рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃў:
  - **MAE** 
  - **RMSE** 
  - **WMAE** РђЊ weighted MAE
- рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў рЃЊрЃљрЃўрЃџрЃЮрЃњрЃљ **Weights & Biases** рЃърЃџрЃљрЃбрЃцрЃЮрЃарЃЏрЃљрЃќрЃћ
- рЃЋрЃўрЃќрЃБрЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃљ: Feature Importance рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃБрЃџрЃўрЃљ рЃарЃЮрЃњрЃЮрЃарЃф рЃАрЃБрЃарЃљрЃЌрЃў W&B-рЃќрЃћ

| рЃЏрЃћрЃбрЃарЃўрЃЎрЃљ | рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ |
|--------|-------------|
| MAE    | ~{} |
| RMSE   | ~{} |
| WMAE   | ~{} |



---

### рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃћрЃЉрЃў

- XGBoost рЃњрЃљрЃЏрЃЮрЃЕрЃюрЃЊрЃљ рЃарЃЮрЃњрЃЮрЃарЃф рЃАрЃгрЃарЃљрЃцрЃў рЃЊрЃљ рЃћрЃцрЃћрЃЦрЃбрЃБрЃарЃў рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃў рЃЊрЃўрЃЊрЃў рЃЏрЃЮрЃфрЃБрЃџрЃЮрЃЉрЃўрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃАрЃћрЃарЃўрЃћрЃЉрЃќрЃћ.
- Feature Engineering (рЃњрЃљрЃюрЃАрЃљрЃЎрЃБрЃЌрЃарЃћрЃЉрЃўрЃЌ lag рЃЊрЃљ rolling рЃАрЃљрЃерЃБрЃљрЃџрЃЮ) рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃюрЃљрЃЊ рЃќрЃарЃЊрЃўрЃЊрЃљ рЃАрЃўрЃќрЃБрЃАрЃбрЃћрЃА.
- рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃќрЃћ рЃцрЃЮрЃЎрЃБрЃАрЃўрЃарЃћрЃЉрЃБрЃџрЃў рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ (WMAE) рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА, рЃарЃЮрЃЏ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃЎрЃљрЃарЃњрЃљрЃЊ рЃљрЃдрЃгрЃћрЃарЃА рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃўрЃА рЃЦрЃфрЃћрЃЋрЃљрЃА рЃњрЃљрЃюрЃАрЃљрЃЎрЃБрЃЌрЃарЃћрЃЉрЃБрЃџ рЃЎрЃЋрЃўрЃарЃћрЃЉрЃерЃў.




##  рЃЏрЃЮрЃЊрЃћрЃџрЃў: N-BEATS (Neural Basis Expansion Analysis for Time Series)


---

### рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ

- **рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ:**
  - рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃўрЃљ рЃЮрЃа рЃАрЃбрЃћрЃЎрЃљрЃЊ рЃњрЃљрЃДрЃЮрЃцрЃўрЃџрЃў N-BEATS:
    - `Trend` 
    - `Seasonality` 

- **рЃбрЃћрЃЦрЃюрЃўрЃЎрЃБрЃарЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў:**
  - Lookback рЃцрЃљрЃюрЃ»рЃљрЃарЃљ: 52 рЃЎрЃЋрЃўрЃарЃљ  
  - рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃА рЃцрЃљрЃюрЃ»рЃљрЃарЃљ: 8 рЃЎрЃЋрЃўрЃарЃљ  
  - Optimizer: `Adam`  
  - Scheduler: ReduceLROnPlateau  
  - Batch size: 32  
  - Epochs: 100 (рЃЎрЃЮрЃЊрЃерЃў 15 -рЃўрЃљ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃФрЃљрЃџрЃўрЃљрЃю рЃЊрЃўрЃЊ рЃ«рЃљрЃюрЃА рЃБрЃюрЃЊрЃћрЃЉрЃЮрЃЊрЃљ рЃЊрЃљ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃерЃћрЃЋрЃљрЃЏрЃфрЃўрЃарЃћрЃЌ)
  - Early stopping: patience = 20

- **рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ:**
  - рЃњрЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃЊрЃљ `train.csv`, `features.csv`, `stores.csv`
  - рЃЊрЃарЃЮрЃўрЃЌрЃў рЃАрЃћрЃарЃўрЃћрЃЉрЃў рЃерЃћрЃњрЃарЃЮрЃЋрЃЊрЃљ рЃўрЃюрЃЊрЃўрЃЋрЃўрЃЊрЃБрЃљрЃџрЃБрЃарЃљрЃЊ `Store`-рЃАрЃљ рЃЊрЃљ `Dept`-рЃќрЃћ
  - рЃДрЃЋрЃћрЃџрЃљ рЃАрЃћрЃарЃўрЃљрЃЏ рЃњрЃљрЃўрЃљрЃарЃљ рЃАрЃбрЃљрЃюрЃЊрЃљрЃарЃбрЃБрЃџ рЃАрЃЎрЃљрЃџрЃўрЃарЃћрЃЉрЃљрЃќрЃћ (`StandardScaler`)
  - рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў рЃњрЃљрЃарЃЊрЃљрЃўрЃЦрЃЏрЃюрЃљ `TimeSeriesDataset` рЃЎрЃџрЃљрЃАрЃўрЃЌ PyTorch-рЃўрЃА `DataLoader` рЃцрЃЮрЃарЃЏрЃљрЃбрЃерЃў
---

### рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ

- рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ рЃЏрЃЮрЃ«рЃЊрЃљ рЃерЃћрЃЏрЃЊрЃћрЃњрЃў рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃўрЃЌ:
  - **MAE** РђЊ рЃАрЃљрЃерЃБрЃљрЃџрЃЮ рЃљрЃЉрЃАрЃЮрЃџрЃБрЃбрЃБрЃарЃў рЃерЃћрЃфрЃЊрЃЮрЃЏрЃљ  
  - **RMSE** РђЊ рЃцрЃћрЃАрЃЋрЃў рЃАрЃљрЃерЃБрЃљрЃџрЃЮ рЃЎрЃЋрЃљрЃЊрЃарЃљрЃбрЃБрЃџрЃў рЃерЃћрЃфрЃЊрЃЮрЃЏрЃўрЃАрЃњрЃљрЃю  
  - **R┬▓ Score** РђЊ рЃЊрЃћрЃбрЃћрЃарЃЏрЃўрЃюрЃљрЃфрЃўрЃўрЃА рЃЎрЃЮрЃћрЃцрЃўрЃфрЃўрЃћрЃюрЃбрЃў

| рЃЏрЃћрЃбрЃарЃўрЃЎрЃљ | рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ |
|--------|-------------|
| MAE    | ~{рЃерЃћрЃљрЃЋрЃАрЃћ рЃарЃўрЃфрЃ«рЃЋрЃўрЃЌ} |
| RMSE   | ~{рЃерЃћрЃљрЃЋрЃАрЃћ рЃарЃўрЃфрЃ«рЃЋрЃўрЃЌ} |
| R┬▓     | ~{рЃерЃћрЃљрЃЋрЃАрЃћ рЃарЃўрЃфрЃ«рЃЋрЃўрЃЌ} |


---

### рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃЊрЃљрЃАрЃЎрЃЋрЃюрЃћрЃЉрЃў

- **N-BEATS** рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ рЃгрЃљрЃарЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌ рЃљрЃАрЃљрЃ«рЃљрЃЋрЃА рЃарЃЮрЃњрЃЮрЃарЃф рЃњрЃарЃФрЃћрЃџрЃЋрЃљрЃЊрЃўрЃљрЃю рЃбрЃћрЃюрЃЊрЃћрЃюрЃфрЃўрЃћрЃЉрЃА, рЃўрЃАрЃћ рЃАрЃћрЃќрЃЮрЃюрЃБрЃа рЃЏрЃћрЃарЃДрЃћрЃЮрЃЉрЃћрЃЉрЃА.
- рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў рЃАрЃбрЃљрЃЉрЃўрЃџрЃБрЃарЃўрЃљ рЃЏрЃфрЃўрЃарЃћ рЃћрЃърЃЮрЃЦрЃћрЃЉрЃўрЃА рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃўрЃЌрЃљрЃф, рЃарЃљрЃф рЃљрЃЕрЃћрЃюрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃћрЃцрЃћрЃЦрЃбрЃБрЃарЃЮрЃЉрЃљрЃА.




mlflow:  https://dagshub.com/lkata22/walmart-sales-forecasting-final-project.mlflow/#/experiments/1?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

wandb:   https://wandb.ai/lkata22-free-university-of-tbilisi-/walmart-sales-forecasting?nw=nwuserlkata22




  
  

  


 






  
